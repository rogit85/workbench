<!DOCTYPE html>
<html lang="en">
<head>
  <title>Underwriting Workbench — Dashboard</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--brand:#6F1111;--brand-2:#7A1414;--ink:#0F1216;--text:#2A2F33;--muted:#6B757E;--bg:#F6F7F9;--surface:#fff;--border:#E6E9EE;--shadow:0 10px 30px rgba(17,20,24,.06),0 2px 8px rgba(17,20,24,.04);--green:#2E7D32;--amber:#FB8C00;--blue:#1976D2;--grey:#667085}
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui}
    .appbar{position:sticky;top:0;z-index:1000;display:grid;grid-template-columns:280px 1fr auto;gap:16px;align-items:center;padding:14px 20px;background:linear-gradient(180deg,var(--brand),var(--brand-2));color:#fff;box-shadow:var(--shadow)}
    .brand{display:flex;gap:12px;align-items:center}.logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,#fff,rgba(255,255,255,.9));display:grid;place-items:center}
    .logo svg{width:22px;height:22px;fill:var(--brand)}
    .title{font-weight:800}.appnav{display:flex;gap:8px}.navbtn{border:none;background:rgba(255,255,255,.14);color:#fff;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer}.navbtn.primary{background:#fff;color:var(--brand)}
    .profile{display:flex;align-items:center;gap:10px;background:rgba(255,255,255,.14);border:1px solid rgba(255,255,255,.24);border-radius:999px;padding:6px 10px 6px 6px}
    .avatar{width:34px;height:34px;border-radius:999px;background:#fff;display:grid;place-items:center;color:var(--brand);font-weight:900}
    .wrap{max-width:1680px;margin:0 auto;padding:22px;display:grid;gap:16px}
    .btn2{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:#fff;cursor:pointer;font-weight:700}
    .btn2.primary{background:linear-gradient(180deg,var(--brand-2),var(--brand));border-color:transparent;color:#fff}
    .card{background:var(--surface);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow)}
    .hd{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
    .bd{padding:14px 16px}
    .filters{display:flex;gap:8px;flex-wrap:wrap}
    .gridKPI{display:grid;grid-template-columns:repeat(5,1fr);gap:16px}
    .kpi{position:relative;display:flex;align-items:center;justify-content:space-between;border:1px solid var(--border);border-radius:12px;background:#fff;padding:16px}
    .kpi .val{font-size:28px;font-weight:800}.kpi .delta{font-weight:800}.up{color:var(--green)}.down{color:var(--brand)}
    .charts{display:grid;grid-template-columns:1.3fr 1fr;gap:16px}
    svg{width:100%;height:220px}
    table{width:100%;border-collapse:collapse}th,td{padding:10px;border-bottom:1px solid var(--border);font-size:13px;text-align:left}
    th{font-size:11px;text-transform:uppercase;letter-spacing:.12em;color:#6B757E}
  </style>
</head>
<body>
<header class="appbar">
  <div class="brand">
    <div class="logo"><svg viewBox="0 0 24 24"><path d="M12 2l7 3v6c0 5-3.5 8.4-7 9.9C8.5 19.4 5 16 5 11V5l7-3zM12 7a2.75 2.75 0 110 5.5A2.75 2.75 0 0112 7zm0 6.5c-2.8 0-5 1.6-5 3.5v1.2c1.7 1.1 3.5 2 5 2.6 1.5-.6 3.3-1.5 5-2.6V17c0-1.9-2.2-3.5-5-3.5z"/></svg></div>
    <div><div style="font-size:12px;opacity:.9;letter-spacing:.18em;text-transform:uppercase">Underwriting Workbench</div><div class="title">Dashboard</div></div>
  </div>
  <div class="appnav">
    <button class="navbtn" onclick="location.href='index.html'">Home</button>
    <button class="navbtn" onclick="location.href='workqueue.html'">Work Queue</button>
    <button class="navbtn primary" onclick="location.href='dashboard.html'">Dashboard</button>
    <button class="navbtn" onclick="location.href='toolkit.html'">Toolkit</button>
  </div>
  <div class="profile"><div class="avatar">MN</div><div><div style="font-weight:700">Marin Nikolla</div><div style="font-size:12px;opacity:.85">Lead Underwriter</div></div></div>
</header>

<main class="wrap">
  <section class="card">
    <div class="hd"><strong>Filters</strong><button class="btn2" onclick="resetFilters()">Reset</button></div>
    <div class="bd">
      <div class="filters">
        <select id="f_stage" class="btn2"><option value="">Stage: All</option><option>Cleared</option><option>Submissions</option><option>Quoted</option><option>Bound</option></select>
        <select id="f_biz" class="btn2"><option value="">Business: All</option><option>New</option><option>Renewal</option></select>
        <select id="f_lob" class="btn2"><option value="">LOB: All</option><option>Property</option><option>Casualty</option><option>Specialty</option><option>Marine</option></select>
        <select id="f_priority" class="btn2"><option value="">Priority: All</option><option>High</option><option>Medium</option><option>Low</option></select>
        <input id="f_q" class="btn2" placeholder="Search…" />
        <button class="btn2 primary" onclick="applyFilters()">Apply</button>
      </div>
    </div>
  </section>

  <section class="gridKPI" id="kpis"></section>

  <section class="charts">
    <div class="card">
      <div class="hd"><strong>Premium by Stage</strong></div>
      <div class="bd"><svg id="chart1"></svg></div>
    </div>
    <div class="card">
      <div class="hd"><strong>New vs Renewal Count</strong></div>
      <div class="bd"><svg id="chart2"></svg></div>
    </div>
  </section>

  <section class="card">
    <div class="hd"><strong>Team Book</strong></div>
    <div class="bd">
      <div style="overflow:auto">
        <table id="tbl"><thead><tr>
          <th>Client</th><th>LOB</th><th>Product</th><th>New/Renewal</th><th>Stage</th><th>Est. Premium</th><th>Priority</th><th>Broker</th><th>Effective</th>
        </tr></thead><tbody></tbody></table>
      </div>
    </div>
  </section>
</main>

<script>
const SEED=[
 {"id":"a0","insured":"Atlas Foods Group","broker":"Howden","lob":"Property","product":"Food & Bev Package","biz":"Renewal","eff":"2025-10-01","premium":190000,"stage":"Cleared","age":"5h","priority":"Medium","channel":"Broker"},
 {"id":"a1","insured":"Orion AeroSystems","broker":"Crestline Broking","lob":"Property","product":"Aviation PAR","biz":"New","eff":"2025-11-01","premium":980000,"stage":"Quoted","age":"3d","priority":"High","channel":"Broker"},
 {"id":"a2","insured":"Hyperion Biotech","broker":"Apex Risk Partners","lob":"Specialty","product":"Life Science Liability","biz":"New","eff":"2025-12-12","premium":460000,"stage":"Submissions","age":"1d","priority":"Medium","channel":"Direct"},
 {"id":"a3","insured":"Neptune Offshore Wind","broker":"Westshore Willis","lob":"Marine","product":"Offshore Construction","biz":"Renewal","eff":"2025-12-31","premium":1875000,"stage":"Bound","age":"6h","priority":"High","channel":"Broker"},
 {"id":"a4","insured":"Lumenova Data Centers","broker":"Cairnstone","lob":"Property","product":"NatCat Excess","biz":"Renewal","eff":"2025-10-30","premium":1320000,"stage":"Bound","age":"5d","priority":"High","channel":"Direct"},
 {"id":"a5","insured":"Phoenix Rail & Freight","broker":"Gullwing Re","lob":"Casualty","product":"Excess Liability","biz":"New","eff":"2025-11-05","premium":720000,"stage":"Quoted","age":"4d","priority":"Medium","channel":"MGA"},
 {"id":"a6","insured":"Vivid Motors EV","broker":"Aon Global","lob":"Specialty","product":"Tech E&O","biz":"New","eff":"2025-11-20","premium":540000,"stage":"Submissions","age":"1d","priority":"High","channel":"Broker"},
 {"id":"a7","insured":"Evergreen Supermarkets","broker":"Lockton City","lob":"Property","product":"Retail Package","biz":"Renewal","eff":"2025-12-01","premium":310000,"stage":"Submissions","age":"7h","priority":"Medium","channel":"Direct"},
 {"id":"a8","insured":"Silverline Hospitality","broker":"Marsh Europe","lob":"Property","product":"Hotels PAR","biz":"New","eff":"2025-10-12","premium":880000,"stage":"Quoted","age":"2d","priority":"High","channel":"Broker"},
 {"id":"a9","insured":"NorthSea Energy","broker":"Aon Offshore","lob":"Marine","product":"Offshore Construction","biz":"Renewal","eff":"2025-12-31","premium":1750000,"stage":"Bound","age":"2d","priority":"High","channel":"Broker"}
];
let ALL=[...SEED], VIEW=[...SEED];

const $=s=>document.querySelector(s);
function qs(name){const p=new URLSearchParams(location.search);return p.get(name)||''}
function currency(n){return (+n).toLocaleString('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0})}

function applyFilters(fromQuery=false){
  const fStage=$('#f_stage').value, fBiz=$('#f_biz').value, fLOB=$('#f_lob').value, fPri=$('#f_priority').value, fq=($('#f_q').value||'').toLowerCase();
  VIEW=ALL.filter(r=>{
    const okStage=!fStage||r.stage===fStage;
    const okBiz=!fBiz||r.biz===fBiz;
    const okLOB=!fLOB||r.lob===fLOB;
    const okPri=!fPri||r.priority===fPri;
    const okQ=!fq||[r.insured,r.broker,r.product,r.lob,r.stage,r.biz,r.priority,String(r.premium)].join(' ').toLowerCase().includes(fq);
    return okStage&&okBiz&&okLOB&&okPri&&okQ;
  });
  render();
}
function resetFilters(){ ['f_stage','f_biz','f_lob','f_priority','f_q'].forEach(id=>{const el=$('#'+id); el.value='';}); VIEW=[...ALL]; render(); }

function renderKPIs(){
  const bounds=VIEW.filter(r=>r.stage==='Bound').reduce((a,b)=>a+(+b.premium||0),0);
  const quoted=VIEW.filter(r=>r.stage==='Quoted').reduce((a,b)=>a+(+b.premium||0),0);
  const inbound=VIEW.filter(r=>r.stage==='Submissions').length;
  const newPrem=VIEW.filter(r=>r.biz==='New').reduce((a,b)=>a+(+b.premium||0),0);
  const renPrem=VIEW.filter(r=>r.biz==='Renewal').reduce((a,b)=>a+(+b.premium||0),0);
  $('#kpis').innerHTML=[['Written',bounds],['Quoted',quoted],['Inbound (7d)',inbound],['New',newPrem],['Renewal',renPrem]].map(([t,v])=>`
    <div class="card kpi"><div><div style="font-size:12px;color:#6B757E;text-transform:uppercase;letter-spacing:.12em">${t}</div><div class="val">${typeof v==='number' && t!=='Inbound (7d)'?currency(v):v}</div></div><div class="delta up">↑</div></div>
  `).join('');
}
function renderCharts(){
  const s1=document.getElementById('chart1'), s2=document.getElementById('chart2');
  const byStage={'Cleared':0,'Submissions':0,'Quoted':0,'Bound':0};
  VIEW.forEach(r=>{ if(byStage[r.stage]!=null) byStage[r.stage]+= +r.premium||0; });
  const st=Object.keys(byStage), val=Object.values(byStage); const max=Math.max(...val,1);
  s1.innerHTML=barSVG(st,val,max);

  const newC=VIEW.filter(r=>r.biz==='New').length, renC=VIEW.filter(r=>r.biz==='Renewal').length;
  s2.innerHTML=barSVG(['New','Renewal'],[newC,renC],Math.max(newC,renC,1));
}
function barSVG(labels,values,max){
  const w=600,h=220, pad=30, bw=(w-2*pad)/values.length*0.6; let svg=`<svg viewBox="0 0 ${w} ${h}">`;
  values.forEach((v,i)=>{ const x=pad + i*((w-2*pad)/values.length)+((w-2*pad)/values.length-bw)/2; const barH=(h-70)*(v/max);
    svg+=`<rect x="${x}" y="${h-40-barH}" width="${bw}" height="${barH}" rx="6" ry="6" fill="#7A1414" />`;
    svg+=`<text x="${x+bw/2}" y="${h-20}" font-size="12" fill="#6B757E" text-anchor="middle">${labels[i]}</text>`;
    svg+=`<text x="${x+bw/2}" y="${h-48-barH}" font-size="12" fill="#2A2F33" text-anchor="middle">${values[i]}</text>`;
  });
  svg+='</svg>'; return svg;
}
function renderTable(){
  const tb=document.querySelector('#tbl tbody'); tb.innerHTML=VIEW.map(r=>`
    <tr onclick="location.href='risk.html?id=${encodeURIComponent(r.id)}'">
      <td>${r.insured}</td><td>${r.lob}</td><td>${r.product}</td><td>${r.biz}</td><td>${r.stage}</td><td>${currency(r.premium)}</td><td>${r.priority}</td><td>${r.broker}</td><td>${r.eff}</td>
    </tr>`).join('');
}
function render(){ renderKPIs(); renderCharts(); renderTable(); }

(function initFromQuery(){
  const f=qs('filter');
  if(!f) return render();
  if(f==='new') $('#f_biz').value='New';
  else if(f==='renewal') $('#f_biz').value='Renewal';
  else if(f==='written') $('#f_stage').value='Bound';
  else if(f==='quoted') $('#f_stage').value='Quoted';
  else if(f==='inbound') $('#f_stage').value='Submissions';
  applyFilters(true);
})();
</script>
</body>
</html>
